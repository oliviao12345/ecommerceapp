<div class="main-content">
    <form [formGroup]="checkoutFormGroup" (ngSubmit)="onSubmit()">
      <div class="text-center">
        <h1>Checkout Page</h1>
      </div>
  
      <!-- CUSTOMER FORM -->
      <div formGroupName="customer" class="form-area">
        <h3>Customer</h3>
        <div class="row">
          <div class="col-md-2">
            <label>First Name</label>
          </div>
          <input formControlName="firstName" type="text">
          <div *ngIf="firstName?.invalid && (firstName?.dirty || firstName?.touched)" class="alert alert-danger">
            <div *ngIf="firstName?.errors?.['required'] || firstName?.errors?.['notOnlyWhitespace']">
              First Name is required
            </div>
            <div *ngIf="firstName?.errors?.['minLength']">
              First Name must be at least 2 characters long
            </div>
          </div>

        </div>
        <div class="row">
          <div class="col-md-2">
            <label>Last Name</label>
          </div>
          <input formControlName="lastName" type="text">
          <div *ngIf="lastName?.invalid && (lastName?.dirty || lastName?.touched)" class="alert alert-danger">
            <div *ngIf="lastName?.errors?.['required']">
              Last Name is required
            </div>
            <div *ngIf="lastName?.errors?.['minLength']">
              Last Name must be at least 2 characters long
            </div>
          </div>

        </div>
        <div class="row">
          <div class="col-md-2">
            <label>Email</label>
          </div>
          <input formControlName="email" type="text">

          <div *ngIf="email?.invalid && (email?.dirty || email?.touched)" class="alert alert-danger">
            <div *ngIf="email?.errors?.['required']">
              Email is required
            </div>
            <div *ngIf="email?.errors?.['pattern']">
              Email must be a valid email address format
            </div>
          </div>

        </div>
      </div>
  
      <!-- SHIPPING ADDRESS FORM -->
      <div formGroupName="shippingAddress" class="form-area">
        <h3>Shipping Address</h3>
        <div class="row">
          <div class="col-md-2">
            <label>Country</label>
          </div>
          <select formControlName="country" (change)="getTowns('shippingAddress')">
          <option *ngFor="let country of countries" [ngValue]="country">
            {{ country.name }}
          </option>
        </select>
        <div *ngIf="shippingAddressCity?.invalid && (shippingAddressCountry?.dirty || shippingAddressCountry?.touched)" class="alert alert-danger">
            <div *ngIf="shippingAddressCountry?.errors?.['required']">
              Country is required
            </div>
        </div>

      </div>
      <div class="row">
        <div class="col-md-2">
            <label>Street</label>
          </div>
          <input formControlName="street" type="text" />
        </div>
        <div *ngIf="shippingAddressStreet?.invalid && (shippingAddressStreet?.dirty || shippingAddressStreet?.touched)" class="alert alert-danger">
            <div *ngIf="shippingAddressStreet?.errors?.['required']">
              Street is required
            </div>
            <div *ngIf="shippingAddressStreet?.errors?.['minLength']">
              Street must be at least 2 characters long
            </div>
          </div>

        <div class="row">
          <div class="col-md-2">
            <label>City</label>
          </div>
          <input formControlName="city" type="text" />
          <div *ngIf="shippingAddressCity?.invalid && (shippingAddressCity?.dirty || shippingAddressCity?.touched)" class="alert alert-danger">
            <div *ngIf="shippingAddressCity?.errors?.['required']">
              City is required
            </div>
            <div *ngIf="shippingAddressCity?.errors?.['minLength']">
              City must be at least 2 characters long
            </div>
          </div>

        </div>
        <div class="row">
          <div class="col-md-2">
            <label>Town</label>
          </div>
          <select formControlName="town">
            <option *ngFor="let town of shippingAddressTowns" [ngValue]="town">
            {{ town.name }}
            </option>
          </select>
          <div *ngIf="shippingAddressTown?.invalid && (shippingAddressTown?.dirty || shippingAddressTown?.touched)" class="alert alert-danger">
            <div *ngIf="shippingAddressTown?.errors?.['required']">
              Town is required
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-2">
            <label>Post Code</label>
          </div>
          <input formControlName="postCode" type="text" />
          <div *ngIf="shippingAddressPostcode?.invalid && (shippingAddressPostcode?.dirty || shippingAddressPostcode?.touched)" class="alert alert-danger">
            <div *ngIf="shippingAddressPostcode?.errors?.['required']">
              Postcode is required
            </div>
            <div *ngIf="shippingAddressPostcode?.errors?.['minLength']">
              Postcode must be at least 2 characters long
            </div>
          </div>
        </div>

      </div>
      <!-- Checkbox to copy shipping to billing -->
      <div class="input-space">
        <label class="au-checkbox">
            <input type="checkbox" (change)="copyShippingAddressToBillingAddress($event)">
            <span class="au-checkmark"></span>Billing Address Same As Shipping Address
        </label>
      </div>
  
      <!-- BILLING ADDRESS FORM -->
      <div formGroupName="billingAddress" class="form-area">
        <h3>Billing Address</h3>
        <div class="row">
          <div class="col-md-2">
            <label>Country</label>
          </div>
          <select formControlName="country" (change)="getTowns('billingAddress')">
            <option *ngFor="let country of countries" [ngValue]="country">
                {{ country.name }}
              </option>
            </select>
            <div *ngIf="billingAddressCountry?.invalid && (billingAddressCountry?.dirty || billingAddressCountry?.touched)" class="alert alert-danger">
            
                <div *ngIf="billingAddressCountry?.errors?.['required'] || billingAddressCountry?.errors?.['notOnlyWhitespace']">
                Country is required
                </div>
            </div>
        </div>
        <div class="row">
          <div class="col-md-2">
            <label>Street</label>
          </div>
          <input formControlName="street" type="text" />
        </div>
        <div *ngIf="billingAddressStreet?.invalid && (billingAddressStreet?.dirty || billingAddressStreet?.touched)" class="alert alert-danger">
            <div *ngIf="billingAddressStreet?.errors?.['required']">
              Street is required
            </div>
            <div *ngIf="billingAddressStreet?.errors?.['minLength']">
              Street must be at least 2 characters long
            </div>
          </div>

        <div class="row">
          <div class="col-md-2">
            <label>City</label>
          </div>
          <input formControlName="city" type="text" />
          <div *ngIf="billingAddressCity?.invalid && (billingAddressCity?.dirty || billingAddressCity?.touched)" class="alert alert-danger">
            <div *ngIf="billingAddressCity?.errors?.['required']">
              City is required
            </div>
            <div *ngIf="billingAddressCity?.errors?.['minLength']">
              City must be at least 2 characters long
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-2">
            <label>Town</label>
          </div>
          <select formControlName="town">
            <option *ngFor="let town of billingAddressTowns" [ngValue]="town">
            {{ town.name }}
            </option>
          </select>
          <div *ngIf="billingAddressTown?.invalid && (billingAddressTown?.dirty || billingAddressTown?.touched)" class="alert alert-danger">
            <div *ngIf="billingAddressTown?.errors?.['required']">
              Town is required
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-2">
            <label>Post Code</label>
          </div>
          <input formControlName="postCode" type="text" />
          <div *ngIf="billingAddressPostcode?.invalid && (billingAddressPostcode?.dirty || billingAddressPostcode?.touched)" class="alert alert-danger">
            <div *ngIf="billingAddressPostcode?.errors?.['required']">
              Postcode is required
            </div>
            <div *ngIf="billingAddressPostcode?.errors?.['minLength']">
              Postcode must be at least 2 characters long
            </div>
          </div>
        </div>
      </div>
  
      <!-- CREDIT CARD FORM -->
      <div formGroupName="creditCard" class="form-area">
        <h3>Credit Card</h3>
  
        <div class="row">
          <div class="col-md-2">
            <label>Card Type</label>
          </div>
          <!-- Dropdown for Card Type -->
          <select formControlName="cardType">
            <option value="visa">Visa</option>
            <option value="mastercard">Mastercard</option>
            <option value="amex">American Express</option>
            <option value="discover">Discover</option>
            <option value="other">Other</option>
          </select>
          <!-- End of Dropdown for Card Type -->
        </div>
        <div class="row">
          <div class="col-md-2">
            <label>Name on Card</label>
          </div>
          <input formControlName="nameOnCard" type="text" />
          <div *ngIf="ccNameOnCard?.invalid && (ccNameOnCard?.dirty || ccNameOnCard?.touched)" class="alert alert-danger">
            <div *ngIf="ccNameOnCard?.errors?.['required'] || ccNameOnCard?.errors?.['notOnlyWhitespace']">
              Name on card is required
            </div>
            <div *ngIf="ccNameOnCard?.errors?.['minLength']">
               Name on card must be at least 2 characters long
            </div>
          </div>

        </div>
        <div class="row">
          <div class="col-md-2">
            <label>Card Number</label>
          </div>
          <input formControlName="cardNumber" type="text" />
          <div *ngIf="ccCardNumber?.invalid && (ccCardNumber?.dirty || ccCardNumber?.touched)" class="alert alert-danger">
            <div *ngIf="ccCardNumber?.errors?.['required']">
              Card Number is required
            </div>
            <div *ngIf="ccCardNumber?.errors?.['minlength']">
              Card Number must be at least 16 digits long
            </div>
            
          </div>
        </div>
        
        <div class="row">
          <div class="col-md-2">
            <label>Expiration Month</label>
          </div>
          <!-- Populate drop down list with checkout.ts Component "creditCardMonths" -->
          <select formControlName="expMonth">
            <option *ngFor="let month of creditCardMonths">
            {{ month }}
            </option>
          </select>
          <div *ngIf="ccExpMonth?.invalid && (ccExpMonth?.dirty || ccExpMonth?.touched)" class="alert alert-danger">
            <div *ngIf="ccExpMonth?.errors?.['required'] || ccExpMonth?.errors?.['notOnlyWhitespace']">
            Expiration Month is Required
            </div>
        </div>
        </div>
        <div class="row">
          <div class="col-md-2">
            <!-- Create a column with a width of 2 columns -->
            <label>Expiration Year</label>
          </div>
        <!-- Populate drop down list with checkout.ts Component "creditCardYears" -->
          <select formControlName="expYear" (change)="handleMonthsAndYears()">
           <option *ngFor="let year of creditCardYears">
            {{ year }}
        </option>
          </select>
          <div *ngIf="ccExpYear?.invalid && (ccExpYear?.dirty || ccExpYear?.touched)" class="alert alert-danger">
            <div *ngIf="ccExpYear?.errors?.['required'] || ccExpYear?.errors?.['notOnlyWhitespace']">
            Expiration year is Required
            </div>
        </div>
        </div>
        <div class="row">
          <div class="col-md-2">
            <label>Security Code</label>
          </div>
          <input formControlName="securityCode" type="text" />
          <div *ngIf="ccSecCode?.invalid && (ccSecCode?.dirty || ccSecCode?.touched)" class="alert alert-danger">
            <div *ngIf="ccSecCode?.errors?.['required'] || ccSecCode?.errors?.['notOnlyWhitespace']">
              Security Code is required
            </div>
            <div *ngIf="ccNameOnCard?.errors?.['minLength']">
               Security Code must be at least 3 Digits long
            </div>
          </div>
        </div>
      </div>
  
      <!-- ORDER DETAILS -->
      <div class="form-area">
        <div class="col mt-4">
          <h3>Review Your Order</h3>
          <p>Total Quantity: {{ totalQuantity }}</p>
          <p>Shipping: FREE</p>
          <p>Total Price: {{ totalPrice | currency: 'GBP'}}</p>
        </div>
      </div>
  
      <!-- SUBMIT BUTTON -->
      <div class="text-center">
        <div class="col mt-4">
          <button type="submit" class="btn btn-info">Purchase</button>
        </div>
      </div>
    </form>
  </div>
